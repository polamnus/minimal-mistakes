
---
layout: single
author_profile: true
read_time: true
comments: false
share: true
related: false
permalink: diy02.html
---
# Advanced DIY Designs
<img src="/media/DIY-Electronic-Project-2.png" width="80%">

What follows are some advanced designs. Be aware, the addition of sensors such as GPS and environmental chips can quickly drive the cost of these radios in terms of not only money but also in terms of energy budget. These radios, while energy efficient, often have drastically different energy budgets once you start adding additional sensors.

For example, the cost of a GPS module is ~$25, inflating the cost of the $37 radio by 67% to $62. However, this *also* takes a battery which had lasted nearly 30 days down to a runtime of just 7 days.

> Always consider your intended use-case and manage your costs and
> expectations in terms of performance, financial cost, and form-factor!

## Upgraded Handheld Node
<img src="/media/handhelds_closed.jpg" width="67%">

My goals had been to introduce an on-board GPS unit. Sadly, this severely impacted the power consumption. Adding an additional battery is impractical so I added a 10mm latching switch to toggle power delivery to the GPS module. To accomplish this just wire such a switch between `IO2` and `GND` on the RAK19700 base board.

> Beware; this may have unintended consequence if additional modules are to be added beyond the RAK12500 GPS module. This design assumes the RAK12500 is the only add-on module, as other modules which rely on the IO2 pin would likely malfunction.

While I had the soldering iron hot, I also added a simple 8mm momentary switch between the `AIN1` and `GND` pins on the RAK19700 base board. Make sure to change the user button pin in the Device configuration to 31 to make this work.

Confirm it's working by watching the `noproto` debug output. The timing of the multi-clicks can be a little tricky at first without a screen to provide feedback.

The user button will:
 - Single Click: Change the page of a screen if it were attached
 - Double Click: Issue an Ad-Hoc NodeInfo request to the mesh
 - Triple Click: Toggle Power Delivery to GPS Radio
 - Quad Click: On Nodes with E-Ink screen, force a screen refresh
 - Long Click(5+ Seconds): Initiate Super Deep Sleep (Near Shutdown)
 - Single Click, While Sleeping: Wake from Super Deep Sleep

Note, the RAK4631 probes for the GPS module at boot-up. If the unit boots or reboots for any reason with the GPS defeat switch engaged it will NOT re-initialize the GPS radio after the switch re-enables power to the module.

Lastly, rather than create a USB, or add some kind of battery door, I added a wireless charging coil so I shouldn't ever need to open the case again aside from deep maintenance.   
 - [Rak Wireless Meshtastic Starter Kit](https://store.rokland.com/products/rak-wireless-wisblock-meshtastic-starter-kit): $37
 - [Rak 12500 GPS Module](https://store.rokland.com/products/rak-wireless-rak12500-gnss-gps-location-module-u-blox-zoe-m8q): $25
 - [1/2 Wave Dipole Antenna](https://www.mouser.com/ProductDetail/712-ANT-915-IPW1-RPS): $12 (Note: RP-SMA!)
 - [Mini PCI to RP-SMA Pigtails](https://www.amazon.com/gp/product/B072VWKXCR)(pk of 6): $14
 - [Handheld Enclosure 1553BYLBK](https://www.digikey.com/en/products/detail/hammond-manufacturing/1553DYLBK/2094892): $10
 - [Enclosure Belt Clip](https://www.digikey.com/en/products/detail/hammond-manufacturing/1599CLIP/460760): $3
 - [NCR18650GA 3450mAh 10A Battery](https://store.rokland.com/products/sanyo-ncr18650ga-3450mah-10a-battery-lilygo-ttgo-meshtastic-t-beam)(pk of 2): $12
 - [18650 Battery Holder](https://www.amazon.com/DIANN-10pcs-Battery-Holder-Single/dp/B0BJV7SK5D/)(pk of 10): $6
 - [Latching On/Off Switch - 10mm](https://www.amazon.com/gp/product/B07MQ86LYD)(pk of 3): $12
 - [Momentary Switch - 8mm[(https://www.amazon.com/LICTOP-Button-Switch-Mounting-Momentary/dp/B07FY9R115)(pk of 10): $8
 - [Wireless Charging Coil](https://www.amazon.com/dp/B08RDMRZL5)(pk of 2): $10
**Total: ~$106**

Once again, you can obtain some substantial cost savings through eBay, these prices are meant to represent worst-case real world prices as of May, 2024. 

<img src="/media/handhelds_open.jpg" width="67%"><img src="/media/handheld_solo.jpg" width="67%">

Given the cost and substantial drain to the battery system, I would not recommend the RAK12500 to a casual user. Any portable node is likely intended to be paired with a phone app, which provides GPS to the mesh accurately and without taxing the mesh radio's budget. 

## [Let's move on to Software](/app.html)
<img src="/media/meshtastic-logo.png">
